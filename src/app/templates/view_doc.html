{% extends "base.html" %}
{% block content %}
<style>
  .doc-content {
    background: #1e1e1e;
    border: 1px solid #444;
    border-radius: 8px;
    padding: 20px;
    margin-top: 15px;
    white-space: pre-wrap;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    line-height: 1.6;
  }
  .doc-meta {
    color: #888;
    margin-bottom: 15px;
  }
  .doc-actions {
    margin-top: 20px;
    display: flex;
    gap: 10px;
  }
  .doc-actions a {
    padding: 8px 16px;
    background: #333;
    color: #fff;
    text-decoration: none;
    border-radius: 4px;
    border: 1px solid #555;
  }
  .doc-actions a:hover {
    background: #444;
  }
  /* Markdown styles */
  .doc-content strong { font-weight: bold; color: #fff; }
  .doc-content em { font-style: italic; color: #ccc; }
  .doc-content code {
    background: #2d2d2d;
    padding: 2px 6px;
    border-radius: 3px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.9em;
  }
  .doc-content .md-h1 { font-size: 1.5em; font-weight: bold; color: #fff; margin: 15px 0 10px 0; display: block; }
  .doc-content .md-h2 { font-size: 1.3em; font-weight: bold; color: #ddd; margin: 12px 0 8px 0; display: block; }
  .doc-content .md-h3 { font-size: 1.1em; font-weight: bold; color: #ccc; margin: 10px 0 6px 0; display: block; }
</style>

<h2>{{ doc['source'] }}</h2>

<div class="doc-meta">
  {% if doc['document_date'] %}
  <strong>Date:</strong> {{ doc['document_date'] }}
  {% endif %}
</div>

<div class="doc-content" id="doc-content">{{ doc['content'] }}</div>

<div class="doc-actions">
  <a href="/documents/{{ doc['id'] }}/edit">Edit Document</a>
  <a href="/documents">‚Üê Back to Documents</a>
</div>

<script>
function parseMarkdown(text) {
  if (!text) return '';
  
  // Headers (must come before other processing)
  text = text.replace(/^### (.+)$/gm, '<span class="md-h3">$1</span>');
  text = text.replace(/^## (.+)$/gm, '<span class="md-h2">$1</span>');
  text = text.replace(/^# (.+)$/gm, '<span class="md-h1">$1</span>');
  
  // Inline code
  text = text.replace(/`([^`]+)`/g, '<code>$1</code>');
  
  // Bold
  text = text.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
  
  // Italic
  text = text.replace(/\*([^*]+)\*/g, '<em>$1</em>');
  
  return text;
}

document.addEventListener('DOMContentLoaded', function() {
  const content = document.getElementById('doc-content');
  if (content) {
    content.innerHTML = parseMarkdown(content.textContent);
  }
});
</script>
{% endblock %}
